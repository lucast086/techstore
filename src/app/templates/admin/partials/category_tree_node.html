<div class="category-node" style="margin-left: {{ node.level * 2 }}rem">
  <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded">
    <div class="flex items-center">
      {% if node.children %}
      <button
        onclick="toggleCategory({{ node.id }})"
        class="mr-2 text-gray-400 hover:text-gray-600"
      >
        <svg
          id="category-{{ node.id }}-icon"
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </button>
      {% else %}
      <span class="mr-2 w-4"></span>
      {% endif %}

      <span class="font-medium">{{ node.name }}</span>

      <span class="ml-4 text-sm text-gray-500">
        ({{ node.product_count }} productos)
      </span>

      {% if not node.is_active %}
      <span class="ml-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded"
        >Inactiva</span
      >
      {% endif %}
    </div>

    <div class="flex items-center space-x-2">
      <a
        href="/admin/categories/{{ node.id }}/edit"
        class="text-indigo-600 hover:text-indigo-900 text-sm"
        hx-get="/admin/categories/{{ node.id }}/edit"
        hx-target="#categories-container"
        hx-push-url="true"
      >
        Editar
      </a>
      {% if node.product_count == 0 %}
      <button
        onclick="deleteCategory({{ node.id }})"
        class="text-red-600 hover:text-red-900 text-sm"
        hx-post="/admin/categories/{{ node.id }}/delete"
        hx-confirm="¿Estás seguro de que deseas eliminar esta categoría?"
        hx-target="#categories-container"
      >
        Eliminar
      </button>
      {% endif %}
    </div>
  </div>

  {% if node.children %}
  <div id="category-{{ node.id }}-content" class="hidden">
    {% for child in node.children %} {% set node = child %} {% include
    "admin/partials/category_tree_node.html" %} {% endfor %}
  </div>
  {% endif %}
</div>
